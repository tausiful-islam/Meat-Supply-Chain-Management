<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reports Dashboard - MeatChain Pro</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="../assests/Style/style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body style="background-color: #f8f9fa;">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4">
  <a class="navbar-brand fw-bold" href="#" id="brandLink"><i class="bi bi-truck me-2"></i>MeatChain Pro</a>
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav me-auto" id="navItems">
      <!-- Navigation items will be loaded based on user role -->
    </ul>
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="login.html"><i class="bi bi-box-arrow-right me-2"></i>Logout</a>
      </li>
    </ul>
  </div>
</nav>

<div class="container-fluid mt-4">
  <!-- Header Section -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="text-danger fw-bold mb-0"><i class="bi bi-file-earmark-bar-graph me-2"></i>Reports Dashboard</h2>
      <p class="text-muted mb-0">Comprehensive business reports and analytics</p>
    </div>
    <button class="btn btn-danger" onclick="downloadPDF()">
      <i class="bi bi-download me-2"></i>Download Report
    </button>
  </div>

  <!-- Filters -->
  <div class="card border-0 shadow-sm mb-4">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3 mb-2">
          <label class="form-label fw-semibold">Report Type</label>
          <select id="reportType" class="form-select">
            <option value="inventory">Inventory Reports</option>
            <option value="orders">Order Reports</option>
            <option value="suppliers">Supplier Performance</option>
            <option value="sales">Sales Analytics</option>
            <option value="financial">Financial Summary</option>
          </select>
        </div>
        <div class="col-md-3 mb-2">
          <label class="form-label fw-semibold">Start Date</label>
          <input type="date" id="startDate" class="form-control" />
        </div>
        <div class="col-md-3 mb-2">
          <label class="form-label fw-semibold">End Date</label>
          <input type="date" id="endDate" class="form-control" />
        </div>
        <div class="col-md-3 mb-2">
          <label class="form-label fw-semibold">&nbsp;</label>
          <button id="filterBtn" class="btn btn-danger w-100 d-block">
            <i class="bi bi-funnel me-2"></i>Generate Report
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts -->
  <div class="row g-4" id="reportContent">
    <div class="col-lg-6 col-md-12">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-danger text-white">
          <h5 class="mb-0"><i class="bi bi-box-seam me-2"></i>Inventory Status</h5>
        </div>
        <div class="card-body">
          <div class="chart-container" style="position: relative; height: 300px;">
            <canvas id="inventoryChart"></canvas>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-6 col-md-12">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-success text-white">
          <h5 class="mb-0"><i class="bi bi-graph-up me-2"></i>Sales Performance</h5>
        </div>
        <div class="card-body">
          <div class="chart-container" style="position: relative; height: 300px;">
            <canvas id="salesChart"></canvas>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-6 col-md-12">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-warning text-dark">
          <h5 class="mb-0"><i class="bi bi-clipboard-data me-2"></i>Order Status</h5>
        </div>
        <div class="card-body">
          <div class="chart-container" style="position: relative; height: 300px;">
            <canvas id="orderChart"></canvas>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-6 col-md-12">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-info text-white">
          <h5 class="mb-0"><i class="bi bi-people me-2"></i>Supplier Performance</h5>
        </div>
        <div class="card-body">
          <div class="chart-container" style="position: relative; height: 300px;">
            <canvas id="supplierChart"></canvas>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Summary Statistics -->
  <div class="row mt-4">
    <div class="col-12">
      <div class="card border-0 shadow-sm">
        <div class="card-header bg-dark text-white">
          <h5 class="mb-0"><i class="bi bi-table me-2"></i>Summary Statistics</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-3 text-center border-end">
              <h4 class="text-danger mb-1">$125,450</h4>
              <small class="text-muted">Total Revenue</small>
            </div>
            <div class="col-md-3 text-center border-end">
              <h4 class="text-success mb-1">486</h4>
              <small class="text-muted">Orders Processed</small>
            </div>
            <div class="col-md-3 text-center border-end">
              <h4 class="text-warning mb-1">12</h4>
              <small class="text-muted">Active Suppliers</small>
            </div>
            <div class="col-md-3 text-center">
              <h4 class="text-info mb-1">2,850kg</h4>
              <small class="text-muted">Products Sold</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    checkAuth();
    setupBrandNavigation();
    loadNavigation();
    initializeCharts();
});

function checkAuth() {
    const user = JSON.parse(localStorage.getItem('loggedInUser'));
    if (!user) {
        window.location.href = 'login.html';
        return;
    }
    
   
    if (user.role !== 'admin') {
        window.location.href = 'customer_dashboard.html';
        return;
    }
}

function setupBrandNavigation() {
    const user = JSON.parse(localStorage.getItem('loggedInUser'));
    const brandLink = document.getElementById('brandLink');
    
    if (user) {
        // User is logged in, redirect to appropriate dashboard
        if (user.role === 'admin') {
            brandLink.href = 'admin_dashboard.html';
        } else if (user.role === 'customer') {
            brandLink.href = 'customer_dashboard.html';
        }
    } else {
        // User is not logged in, redirect to home page
        brandLink.href = '../index.html';
    }
}

function loadNavigation() {
    const user = JSON.parse(localStorage.getItem('loggedInUser'));
    if (!user) return;
    
    const navItems = document.getElementById('navItems');
    if (user.role === 'admin') {
        navItems.innerHTML = `
            <li class="nav-item"><a class="nav-link" href="admin_dashboard.html">Dashboard</a></li>
            <li class="nav-item"><a class="nav-link" href="inventory.html">Inventory</a></li>
            <li class="nav-item"><a class="nav-link" href="suppliers.html">Suppliers</a></li>
            <li class="nav-item"><a class="nav-link" href="orders.html">Orders</a></li>
            <li class="nav-item"><a class="nav-link" href="analytics.html">Analytics</a></li>
            <li class="nav-item"><a class="nav-link active" href="reports.html">Reports</a></li>
        `;
    }
}

function initializeCharts() {
    
    const inventoryData = {
        labels: ['Beef', 'Pork', 'Chicken', 'Lamb', 'Turkey'],
        datasets: [{
            label: 'Stock Level (kg)',
            data: [1200, 800, 1500, 400, 600],
            backgroundColor: ['#dc3545', '#fd7e14', '#ffc107', '#198754', '#0dcaf0']
        }]
    };

    new Chart(document.getElementById('inventoryChart'), {
        type: 'bar',
        data: inventoryData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false }
            }
        }
    });


    const salesData = {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
        datasets: [{
            label: 'Sales ($)',
            data: [18500, 22000, 19800, 25600, 23400, 28200],
            borderColor: '#198754',
            backgroundColor: 'rgba(25, 135, 84, 0.1)',
            fill: true,
            tension: 0.4
        }]
    };

    new Chart(document.getElementById('salesChart'), {
        type: 'line',
        data: salesData,
        options: {
            responsive: true,
            maintainAspectRatio: false
        }
    });

    
    const orderData = {
        labels: ['Pending', 'Processing', 'Shipped', 'Delivered', 'Cancelled'],
        datasets: [{
            label: 'Orders',
            data: [15, 28, 35, 185, 8],
            backgroundColor: ['#ffc107', '#0dcaf0', '#0d6efd', '#198754', '#dc3545']
        }]
    };

    new Chart(document.getElementById('orderChart'), {
        type: 'doughnut',
        data: orderData,
        options: {
            responsive: true,
            maintainAspectRatio: false
        }
    });

    
    const supplierData = {
        labels: ['Premium Meats Co.', 'Fresh Farm Supply', 'Quality Cuts Inc.', 'Local Butchers', 'Organic Farms'],
        datasets: [{
            label: 'Delivery Rate (%)',
            data: [95, 88, 92, 85, 98],
            backgroundColor: '#17a2b8'
        }]
    };

    new Chart(document.getElementById('supplierChart'), {
        type: 'bar',
        data: supplierData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            indexAxis: 'y',
            plugins: {
                legend: { display: false }
            }
        }
    });
}

function downloadPDF() {
    showNotification('Generating PDF report...', 'info');
    
    // Simulate PDF generation
    setTimeout(() => {
        const link = document.createElement('a');
        link.href = 'data:application/pdf;base64,JVBERi0xLjQKJdP0zOEKMSAwIG9iago8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFIKPj4KZW5kb2JqCjIgMCBvYmoKPDwKL1R5cGUgL1BhZ2VzCi9LaWRzIFszIDAgUl0KL0NvdW50IDEKPD4KZW5kb2JqCjMgMCBvYmoKPDwKL1R5cGUgL1BhZ2UKL1BhcmVudCAyIDAgUgovTWVkaWFCb3ggWzAgMCA2MTIgNzkyXQovQ29udGVudHMgNCAwIFIKPj4KZW5kb2JqCjQgMCBvYmoKPDwKL0xlbmd0aCA0NAo+PgpzdHJlYW0KQLQKMC4wNzUgMCA2MTIgNzkyIDYxMiAwIDAgMCA2MTJKS2VuZHN0cmVhbQt4cmVmCjAgNQowMDAwMDAwMDAwIDY1NTM1IGYKMDAwMDAwMDAwOSAwMDAwMCBuCjAwMDAwMDAwNzQgMDAwMDAgbgowMDAwMDAwMTIwIDAwMDAwIG4KMDAwMDAwMDE3OSAwMDAwMCBuCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAxIDAgUgo+PgpzdGFydHhyZWYKMjczCiUlRU9GCg==';
        link.download = 'meatchain-report.pdf';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showNotification('Report downloaded successfully!', 'success');
    }, 2000);
}

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
    notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
    notification.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
        }
    }, 5000);
}
</script>
</body>
</html>
