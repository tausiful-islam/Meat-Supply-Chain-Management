<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Suppliers Management - MeatChain Pro</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="../assests/Style/style.css">
</head>
<body style="background-color: #f8f9fa;">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4">
  <a class="navbar-brand fw-bold" href="#" id="brandLink"><i class="bi bi-truck me-2"></i>MeatChain Pro</a>
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav me-auto">
      <li class="nav-item"><a class="nav-link" href="admin_dashboard.html">Dashboard</a></li>
      <li class="nav-item"><a class="nav-link" href="inventory.html">Inventory</a></li>
      <li class="nav-item"><a class="nav-link active" href="suppliers.html">Suppliers</a></li>
      <li class="nav-item"><a class="nav-link" href="orders.html">Orders</a></li>
      <li class="nav-item"><a class="nav-link" href="analytics.html">Analytics</a></li>
      <li class="nav-item"><a class="nav-link" href="reports.html">Reports</a></li>
      <li class="nav-item"><a class="nav-link" href="historical_data.html">Historical Data</a></li>
    </ul>
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="login.html"><i class="bi bi-box-arrow-right me-2"></i>Logout</a>
      </li>
    </ul>
  </div>
</nav>

<div class="container-fluid mt-4">
  <!-- Header Section -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="text-danger fw-bold mb-0"><i class="bi bi-people me-2"></i>Suppliers Management</h2>
      <p class="text-muted mb-0">Manage your supply chain partners</p>
    </div>
    <button class="btn btn-danger btn-lg" data-bs-toggle="modal" data-bs-target="#addSupplierModal">
      <i class="bi bi-plus-circle me-2"></i>Add New Supplier
    </button>
  </div>

  <!-- Statistics Cards -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card border-0 shadow-sm">
        <div class="card-body text-center">
          <i class="bi bi-people display-4 text-primary mb-2"></i>
          <h5 class="card-title">Total Suppliers</h5>
          <h3 class="text-primary" id="totalSuppliers">0</h3>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card border-0 shadow-sm">
        <div class="card-body text-center">
          <i class="bi bi-check-circle display-4 text-success mb-2"></i>
          <h5 class="card-title">Active</h5>
          <h3 class="text-success" id="activeSuppliers">0</h3>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card border-0 shadow-sm">
        <div class="card-body text-center">
          <i class="bi bi-star display-4 text-warning mb-2"></i>
          <h5 class="card-title">Premium Partners</h5>
          <h3 class="text-warning" id="premiumSuppliers">0</h3>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card border-0 shadow-sm">
        <div class="card-body text-center">
          <i class="bi bi-geo-alt display-4 text-info mb-2"></i>
          <h5 class="card-title">Locations</h5>
          <h3 class="text-info" id="locations">0</h3>
        </div>
      </div>
    </div>
  </div>

  <!-- Search and Filter Section -->
  <div class="search-filters">
    <div class="row">
      <div class="col-md-4">
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-search"></i></span>
          <input type="text" id="searchInput" class="form-control" placeholder="Search suppliers...">
        </div>
      </div>
      <div class="col-md-3">
        <select id="categoryFilter" class="form-select">
          <option value="">All Categories</option>
          <option value="Beef">Beef Suppliers</option>
          <option value="Pork">Pork Suppliers</option>
          <option value="Chicken">Chicken Suppliers</option>
          <option value="Fish">Fish Suppliers</option>
          <option value="Processed">Processed Meat</option>
        </select>
      </div>
      <div class="col-md-3">
        <select id="statusFilter" class="form-select">
          <option value="">All Status</option>
          <option value="Active">Active</option>
          <option value="Inactive">Inactive</option>
          <option value="Premium">Premium</option>
        </select>
      </div>
      <div class="col-md-2">
        <button class="btn btn-outline-danger w-100" onclick="clearFilters()">
          <i class="bi bi-arrow-clockwise me-1"></i>Clear
        </button>
      </div>
    </div>
  </div>

  <!-- Suppliers Table -->
  <div class="table-responsive">
    <table class="table table-hover align-middle" id="suppliersTable">
      <thead class="table-danger">
        <tr>
          <th>Supplier ID</th>
          <th>Company Name</th>
          <th>Contact Person</th>
          <th>Category</th>
          <th>Location</th>
          <th>Phone</th>
          <th>Rating</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="suppliersTableBody">
        <!-- Supplier data will be loaded here -->
      </tbody>
    </table>
  </div>
</div>

<!-- Add Supplier Modal -->
<div class="modal fade" id="addSupplierModal" tabindex="-1" aria-labelledby="addSupplierModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <form id="addSupplierForm">
        <div class="modal-header bg-danger text-white">
          <h5 class="modal-title" id="addSupplierModalLabel">
            <i class="bi bi-plus-circle me-2"></i>Add New Supplier
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Supplier ID</label>
              <input type="text" id="supplierId" class="form-control" required>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Company Name</label>
              <input type="text" id="companyName" class="form-control" required>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Contact Person</label>
              <input type="text" id="contactPerson" class="form-control" required>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Category</label>
              <select id="supplierCategory" class="form-select" required>
                <option value="">Select Category</option>
                <option value="Beef">Beef Supplier</option>
                <option value="Pork">Pork Supplier</option>
                <option value="Chicken">Chicken Supplier</option>
                <option value="Fish">Fish Supplier</option>
                <option value="Processed">Processed Meat</option>
              </select>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Location</label>
              <input type="text" id="location" class="form-control" required>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Phone</label>
              <input type="tel" id="phone" class="form-control" required>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Email</label>
              <input type="email" id="email" class="form-control" required>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Rating</label>
              <select id="rating" class="form-select" required>
                <option value="">Select Rating</option>
                <option value="5">★★★★★ (5)</option>
                <option value="4">★★★★☆ (4)</option>
                <option value="3">★★★☆☆ (3)</option>
                <option value="2">★★☆☆☆ (2)</option>
                <option value="1">★☆☆☆☆ (1)</option>
              </select>
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label">Address</label>
            <textarea id="address" class="form-control" rows="2" required></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-danger">
            <i class="bi bi-check-circle me-1"></i>Add Supplier
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Edit Supplier Modal -->
<div class="modal fade" id="editSupplierModal" tabindex="-1" aria-labelledby="editSupplierModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <form id="editSupplierForm">
        <div class="modal-header bg-warning text-dark">
          <h5 class="modal-title" id="editSupplierModalLabel">
            <i class="bi bi-pencil me-2"></i>Edit Supplier
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="editSupplierIndex">
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Supplier ID</label>
              <input type="text" id="editSupplierId" class="form-control" required>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Company Name</label>
              <input type="text" id="editCompanyName" class="form-control" required>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Contact Person</label>
              <input type="text" id="editContactPerson" class="form-control" required>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Category</label>
              <select id="editSupplierCategory" class="form-select" required>
                <option value="">Select Category</option>
                <option value="Beef">Beef Supplier</option>
                <option value="Pork">Pork Supplier</option>
                <option value="Chicken">Chicken Supplier</option>
                <option value="Fish">Fish Supplier</option>
                <option value="Processed">Processed Meat</option>
              </select>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Location</label>
              <input type="text" id="editLocation" class="form-control" required>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Phone</label>
              <input type="tel" id="editPhone" class="form-control" required>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">Email</label>
              <input type="email" id="editEmail" class="form-control" required>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">Rating</label>
              <select id="editRating" class="form-select" required>
                <option value="">Select Rating</option>
                <option value="5">★★★★★ (5)</option>
                <option value="4">★★★★☆ (4)</option>
                <option value="3">★★★☆☆ (3)</option>
                <option value="2">★★☆☆☆ (2)</option>
                <option value="1">★☆☆☆☆ (1)</option>
              </select>
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label">Address</label>
            <textarea id="editAddress" class="form-control" rows="2" required></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-warning">
            <i class="bi bi-check-circle me-1"></i>Update Supplier
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
// Sample suppliers data
let suppliers = [
    {
        id: 'SUP001',
        companyName: 'Premium Beef Ranch',
        contactPerson: 'John Smith',
        category: 'Beef',
        location: 'Texas',
        phone: '+1 555-0101',
        email: 'john@premiumbeef.com',
        rating: 5,
        status: 'Premium',
        address: '123 Ranch Road, Austin, TX 78701'
    },
    {
        id: 'SUP002',
        companyName: 'Ocean Fresh Seafood',
        contactPerson: 'Maria Rodriguez',
        category: 'Fish',
        location: 'Florida',
        phone: '+1 555-0102',
        email: 'maria@oceanfresh.com',
        rating: 4,
        status: 'Active',
        address: '456 Harbor Blvd, Miami, FL 33101'
    },
    {
        id: 'SUP003',
        companyName: 'Farm Fresh Poultry',
        contactPerson: 'David Johnson',
        category: 'Chicken',
        location: 'Georgia',
        phone: '+1 555-0103',
        email: 'david@farmfresh.com',
        rating: 4,
        status: 'Active',
        address: '789 Farm Lane, Atlanta, GA 30301'
    },
    {
        id: 'SUP004',
        companyName: 'Quality Pork Co.',
        contactPerson: 'Sarah Williams',
        category: 'Pork',
        location: 'Iowa',
        phone: '+1 555-0104',
        email: 'sarah@qualitypork.com',
        rating: 3,
        status: 'Active',
        address: '321 Pig Street, Des Moines, IA 50301'
    },
    {
        id: 'SUP005',
        companyName: 'Premium Processed Meats',
        contactPerson: 'Michael Brown',
        category: 'Processed',
        location: 'Illinois',
        phone: '+1 555-0105',
        email: 'michael@premiumprocessed.com',
        rating: 5,
        status: 'Premium',
        address: '654 Industry Ave, Chicago, IL 60601'
    }
];

// Initialize the application
document.addEventListener('DOMContentLoaded', function() {
    setupBrandNavigation();
    loadSuppliersTable();
    updateStatistics();
    setupEventListeners();
});

// Setup brand navigation based on user login status
function setupBrandNavigation() {
    const user = JSON.parse(localStorage.getItem('loggedInUser'));
    const brandLink = document.getElementById('brandLink');
    
    if (user) {
        // User is logged in, redirect to appropriate dashboard
        if (user.role === 'admin') {
            brandLink.href = 'admin_dashboard.html';
        } else if (user.role === 'customer') {
            brandLink.href = 'customer_dashboard.html';
        }
    } else {
        // User is not logged in, redirect to home page
        brandLink.href = '../index.html';
    }
}

// Load suppliers table
function loadSuppliersTable() {
    const tableBody = document.getElementById('suppliersTableBody');
    tableBody.innerHTML = '';
    
    suppliers.forEach((supplier, index) => {
        const row = createTableRow(supplier, index);
        tableBody.appendChild(row);
    });
}

// Create table row
function createTableRow(supplier, index) {
    const row = document.createElement('tr');
    row.className = 'fade-in';
    
    const statusBadge = getStatusBadge(supplier.status);
    const ratingStars = getRatingStars(supplier.rating);
    
    row.innerHTML = `
        <td><strong>${supplier.id}</strong></td>
        <td>${supplier.companyName}</td>
        <td>${supplier.contactPerson}</td>
        <td><span class="badge bg-secondary">${supplier.category}</span></td>
        <td>${supplier.location}</td>
        <td>${supplier.phone}</td>
        <td>${ratingStars}</td>
        <td>${statusBadge}</td>
        <td>
            <div class="btn-group" role="group">
                <button class="btn btn-sm btn-outline-info" onclick="viewSupplier(${index})" data-bs-toggle="tooltip" title="View Details">
                    <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-sm btn-outline-warning" onclick="editSupplier(${index})" data-bs-toggle="tooltip" title="Edit">
                    <i class="bi bi-pencil"></i>
                </button>
                <button class="btn btn-sm btn-outline-danger" onclick="deleteSupplier(${index})" data-bs-toggle="tooltip" title="Delete">
                    <i class="bi bi-trash"></i>
                </button>
            </div>
        </td>
    `;
    
    return row;
}

// Get status badge
function getStatusBadge(status) {
    const badges = {
        'Active': '<span class="badge bg-success">Active</span>',
        'Inactive': '<span class="badge bg-secondary">Inactive</span>',
        'Premium': '<span class="badge bg-warning text-dark">Premium</span>'
    };
    return badges[status] || '<span class="badge bg-secondary">Unknown</span>';
}

// Get rating stars
function getRatingStars(rating) {
    let stars = '';
    for (let i = 1; i <= 5; i++) {
        if (i <= rating) {
            stars += '<i class="bi bi-star-fill text-warning"></i>';
        } else {
            stars += '<i class="bi bi-star text-muted"></i>';
        }
    }
    return stars;
}

// Update statistics
function updateStatistics() {
    const total = suppliers.length;
    const active = suppliers.filter(s => s.status === 'Active' || s.status === 'Premium').length;
    const premium = suppliers.filter(s => s.status === 'Premium').length;
    const locations = new Set(suppliers.map(s => s.location)).size;
    
    document.getElementById('totalSuppliers').textContent = total;
    document.getElementById('activeSuppliers').textContent = active;
    document.getElementById('premiumSuppliers').textContent = premium;
    document.getElementById('locations').textContent = locations;
}

// Setup event listeners
function setupEventListeners() {
    // Add supplier form
    document.getElementById('addSupplierForm').addEventListener('submit', function(e) {
        e.preventDefault();
        addSupplier();
    });
    
    // Edit supplier form
    document.getElementById('editSupplierForm').addEventListener('submit', function(e) {
        e.preventDefault();
        updateSupplier();
    });
    
    // Search functionality
    document.getElementById('searchInput').addEventListener('input', filterTable);
    document.getElementById('categoryFilter').addEventListener('change', filterTable);
    document.getElementById('statusFilter').addEventListener('change', filterTable);
}

// Add new supplier
function addSupplier() {
    const newSupplier = {
        id: document.getElementById('supplierId').value,
        companyName: document.getElementById('companyName').value,
        contactPerson: document.getElementById('contactPerson').value,
        category: document.getElementById('supplierCategory').value,
        location: document.getElementById('location').value,
        phone: document.getElementById('phone').value,
        email: document.getElementById('email').value,
        rating: parseInt(document.getElementById('rating').value),
        status: 'Active',
        address: document.getElementById('address').value
    };
    
    suppliers.push(newSupplier);
    loadSuppliersTable();
    updateStatistics();
    
    // Close modal and reset form
    const modal = bootstrap.Modal.getInstance(document.getElementById('addSupplierModal'));
    modal.hide();
    document.getElementById('addSupplierForm').reset();
    
    showNotification('Supplier added successfully!', 'success');
}

// Edit supplier
function editSupplier(index) {
    const supplier = suppliers[index];
    
    document.getElementById('editSupplierIndex').value = index;
    document.getElementById('editSupplierId').value = supplier.id;
    document.getElementById('editCompanyName').value = supplier.companyName;
    document.getElementById('editContactPerson').value = supplier.contactPerson;
    document.getElementById('editSupplierCategory').value = supplier.category;
    document.getElementById('editLocation').value = supplier.location;
    document.getElementById('editPhone').value = supplier.phone;
    document.getElementById('editEmail').value = supplier.email;
    document.getElementById('editRating').value = supplier.rating;
    document.getElementById('editAddress').value = supplier.address;
    
    const modal = new bootstrap.Modal(document.getElementById('editSupplierModal'));
    modal.show();
}

// Update supplier
function updateSupplier() {
    const index = parseInt(document.getElementById('editSupplierIndex').value);
    
    suppliers[index] = {
        id: document.getElementById('editSupplierId').value,
        companyName: document.getElementById('editCompanyName').value,
        contactPerson: document.getElementById('editContactPerson').value,
        category: document.getElementById('editSupplierCategory').value,
        location: document.getElementById('editLocation').value,
        phone: document.getElementById('editPhone').value,
        email: document.getElementById('editEmail').value,
        rating: parseInt(document.getElementById('editRating').value),
        status: suppliers[index].status, // Keep existing status
        address: document.getElementById('editAddress').value
    };
    
    loadSuppliersTable();
    updateStatistics();
    
    // Close modal
    const modal = bootstrap.Modal.getInstance(document.getElementById('editSupplierModal'));
    modal.hide();
    
    showNotification('Supplier updated successfully!', 'success');
}

// View supplier details
function viewSupplier(index) {
    const supplier = suppliers[index];
    alert(`Supplier Details:\n\nCompany: ${supplier.companyName}\nContact: ${supplier.contactPerson}\nCategory: ${supplier.category}\nLocation: ${supplier.location}\nPhone: ${supplier.phone}\nEmail: ${supplier.email}\nRating: ${supplier.rating}/5\nStatus: ${supplier.status}\nAddress: ${supplier.address}`);
}

// Delete supplier
function deleteSupplier(index) {
    if (confirm('Are you sure you want to delete this supplier?')) {
        suppliers.splice(index, 1);
        loadSuppliersTable();
        updateStatistics();
        showNotification('Supplier deleted successfully!', 'danger');
    }
}

// Filter table
function filterTable() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    const categoryFilter = document.getElementById('categoryFilter').value;
    const statusFilter = document.getElementById('statusFilter').value;
    
    const filteredSuppliers = suppliers.filter(supplier => {
        const matchesSearch = supplier.companyName.toLowerCase().includes(searchTerm) || 
                            supplier.id.toLowerCase().includes(searchTerm) ||
                            supplier.contactPerson.toLowerCase().includes(searchTerm);
        const matchesCategory = !categoryFilter || supplier.category === categoryFilter;
        const matchesStatus = !statusFilter || supplier.status === statusFilter;
        
        return matchesSearch && matchesCategory && matchesStatus;
    });
    
    const tableBody = document.getElementById('suppliersTableBody');
    tableBody.innerHTML = '';
    
    filteredSuppliers.forEach((supplier, index) => {
        const originalIndex = suppliers.indexOf(supplier);
        const row = createTableRow(supplier, originalIndex);
        tableBody.appendChild(row);
    });
}

// Clear filters
function clearFilters() {
    document.getElementById('searchInput').value = '';
    document.getElementById('categoryFilter').value = '';
    document.getElementById('statusFilter').value = '';
    loadSuppliersTable();
}

// Show notification
function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
    notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
    notification.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
        }
    }, 5000);
}
</script>

</body>
</html>
